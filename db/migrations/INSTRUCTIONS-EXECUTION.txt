================================================================================
INSTRUCTIONS D'EX√âCUTION - Migration Phase 2.3
================================================================================

üìã √âTAPES √Ä SUIVRE :

1. Ouvrir Azure Portal Query Editor
   URL : https://portal.azure.com/#@cotechnoe.net/resource/subscriptions/0f1323ea-0f29-4187-9872-e1cf15d677de/resourceGroups/rg-saasaccel-teams-gpt-02/providers/Microsoft.Sql/servers/sac-02-sql/databases/sac-02AMPSaaSDB/queryEditor

2. S'authentifier avec Azure AD (heon@cotechnoe.net)

3. Copier le contenu du fichier MIGRATION-A-EXECUTER.txt
   (tout le contenu, de USE [sac-02AMPSaaSDB]; jusqu'√† GO final)

4. Coller dans Query Editor

5. Cliquer sur "Run" (bouton en haut)

6. Attendre l'ex√©cution (environ 10-30 secondes)

7. V√©rifier les messages de confirmation dans l'output :
   ‚úì Colonne TeamsUserId ajout√©e
   ‚úì Colonne TeamsConversationId ajout√©e
   ‚úì Colonne TenantId ajout√©e
   ‚úì Index IX_Subscriptions_TeamsUserId cr√©√©
   ‚úì Index IX_Subscriptions_TenantId cr√©√©
   ‚úì Table TeamsMessageLogs cr√©√©e
   ‚úì Vue vw_SubscriptionUsageStats cr√©√©e
   ‚úì Proc√©dure sp_LinkTeamsUserToSubscription cr√©√©e
   ‚úì Version 8.30 enregistr√©e

8. Si tout est OK, message final devrait afficher :
   "Migration Phase 2.3 TERMIN√âE"

================================================================================
APR√àS EX√âCUTION R√âUSSIE :
================================================================================

Signaler √† l'agent : "migration termin√©e"

L'agent lancera alors automatiquement le script de validation (8 tests) pour
s'assurer que toutes les modifications sont correctes.

================================================================================
EN CAS D'ERREUR :
================================================================================

‚ùå Si une erreur survient :
   1. Noter le message d'erreur complet
   2. NE PAS r√©essayer imm√©diatement
   3. Signaler l'erreur √† l'agent avec le message exact

Le script est idempotent, il peut √™tre r√©ex√©cut√© sans danger si n√©cessaire.

================================================================================
INFORMATIONS TECHNIQUES :
================================================================================

Serveur     : sac-02-sql.database.windows.net
Database    : sac-02AMPSaaSDB
Backup cr√©√© : sac-02AMPSaaSDB-backup-20251031
Taille      : 13,790 caract√®res (402 lignes SQL)
Dur√©e       : ~10-30 secondes

Modifications apport√©es :
- 3 nouvelles colonnes dans Subscriptions (TeamsUserId, TeamsConversationId, TenantId)
- 2 nouveaux index de performance
- 1 nouvelle table TeamsMessageLogs (13 colonnes)
- 1 nouvelle vue vw_SubscriptionUsageStats
- 1 nouvelle proc√©dure sp_LinkTeamsUserToSubscription
- Enregistrement version 8.30 dans DatabaseVersionHistory

Toutes les modifications sont NULL/optionnelles, aucun impact sur donn√©es existantes.

================================================================================
